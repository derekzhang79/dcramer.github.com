
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Announcing django-sphinx 2.0.0 Full-text Search - David Cramer's Blog</title>
  <meta name="author" content="David Cramer">

  
  <meta name="description" content="One of my tasks lately has been updating the django-sphinx library to work with Sphinx 0.98, as it includes GIS components which we have been wanting &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dcramer.github.com/2008/04/04/announcing-django-sphinx-200">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/DavidCramernet" rel="alternate" title="David Cramer's Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">David Cramer's Blog</a></h1>
  
    <h2>Python at Scale.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/DavidCramernet" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dcramer.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/archives/">Archives</a></li>
  <li><a href="/resume/">Resume</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Announcing Django-sphinx 2.0.0 Full-text Search</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-04-04T00:00:00-07:00" pubdate data-updated="true">Apr 4<span>th</span>, 2008</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>One of my tasks lately has been updating the <a href="http://code.google.com/p/django-sphinx">django-sphinx</a> library to work with Sphinx 0.98, as it includes GIS components which we have been wanting to possibly utilize on our new search engine. So today, the conclusion of.. very few hours of work, I&#8217;d like to announce 2.0.0 of the Django integration.</p>

<p>The SphinxSearch manager has been completely rewritten to rely strictly on the Python Sphinx API (a request from the author of Sphinx), which means it should have much more compatibility with newer versions in the future. I have also updated the querysets it returns to work like normal Django QuerySet instances, to where they clone themselves so you can fork your queryset into several different actions.</p>

<p>The search results also now have a proxy which wraps each object. This proxy is specifically geared towards <a href="http://code.djangoproject.com/ticket/17">ticket #17</a>, and allows you to access a <code>_sphinx</code> attribute on each instance, without actually modifying that instance. You can also now access a <code>_sphinx</code> attribute on the queryset itself. Both of these contain relative meta-data for their object.</p>

<p>So, a quick usage example using the new API:<br><pre><br>In [1]: from sphinxtest.tests.models import *</p>

<p>In [2]: x = Document.search.query('a')</p>

<p>In [3]: x._sphinx<br>Out[3]:<br>{'total': 10,<br>'total_found': 10,<br>'words': [{'docs': 10, 'hits': 10, 'word': 'a'}]}</p>

<p>In [4]: x<br>Out[4]: [&lt;Document: Document object&gt;, &lt;Document: Document object&gt;, &lt;Document: Document object&gt;, &lt;Document: Document object&gt;, &lt;Document: Document object&gt;, &lt;Document: Document object&gt;, &lt;Document: Document object&gt;, &lt;Document: Document object&gt;, &lt;Document: Document object&gt;, &lt;Document: Document object&gt;]</p>

<p>In [5]: x[0]._sphinx<br>Out[5]: {'weight': 1}</p>

<p>In [6]: x[0].title<br>Out[6]: u'Document 0'</p>

<p>In [7]: type(x)<br>Out[7]: &lt;class 'djangosphinx.SphinxSearch'&gt;</p>

<p>In [8]: type(x[0])<br>Out[8]: &lt;class 'djangosphinx.SphinxProxy'&gt;<br></pre></p>

<p>As you can see, it&#8217;s full backwards compatible. Calling <code>queryset._sphinx</code> will force evaluation on the queryset. Grab the release over at <a href="http://code.google.com/p/django-sphinx">Google code</a>.</p>

<p>Comments and criticism, send em my way :)</p></div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">David Cramer</span></span>

      








  


<time datetime="2008-04-04T00:00:00-07:00" pubdate data-updated="true">Apr 4<span>th</span>, 2008</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://dcramer.github.com/2008/04/04/announcing-django-sphinx-200" data-via="zeeg" data-counturl="http://dcramer.github.com/2008/04/04/announcing-django-sphinx-200" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2008/04/02/segmentation-fault" title="Previous Post: Segmentation Fault">&laquo; Segmentation Fault</a>
      
      
        <a class="basic-alignment right" href="/2008/04/04/ibegin-share-update" title="next Post: iBegin Share Update">iBegin Share Update &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite">

<script type="text/javascript">
      var disqus_shortname = 'davidcramer';
      
        
        // var disqus_developer = 1;
        
            var disqus_identifier = '117 http://www.davidcramer.net/?p=117';
        
        var disqus_url = 'http://dcramer.github.com/2008/04/04/announcing-django-sphinx-200';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>

</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2012/04/24/sticking-with-standards">Sticking With Standards</a>
      </li>
    
      <li class="post">
        <a href="/2012/04/08/using-arrays-as-materialized-paths-in-postgres">Using Arrays as Materialized Paths in Postgres</a>
      </li>
    
      <li class="post">
        <a href="/2011/11/10/scaling-schema-changes">Scaling Schema Changes</a>
      </li>
    
      <li class="post">
        <a href="/2011/08/05/extending-django-nose">Integrating Django with Nose at DISQUS</a>
      </li>
    
      <li class="post">
        <a href="/2011/07/20/python-and-os-x-lion">Python and OS X Lion</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/dcramer">@dcramer</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'dcramer',
            count: 10,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("zeeg", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/zeeg" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @zeeg</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - David Cramer -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'davidcramer';
      
        
        // var disqus_developer = 1;
        
            var disqus_identifier = '117 http://www.davidcramer.net/?p=117';
        
        var disqus_url = 'http://dcramer.github.com/2008/04/04/announcing-django-sphinx-200';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '4f0ffdc0844d521595000001');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>

</body>
</html>
